<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>KSRS REPORT</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script type="text/javascript">
      google
        .charts
        .load("current", {
          packages: ["corechart", "bar", "table"]
        });

      fetch("https://script.google.com/macros/s/AKfycbxdPYhfeOQTkdhDRjAR7ot5-tS6VdWrFMDaP4B9b83uNXc5v9ggV_IxX0lXHorikwtlSA/exec?sheetName=Sheet1", {redirect: "follow"})
        .then((response) => response.text())
        .then((result) => {
          sheetData = JSON.parse(result);
          drawChart(sheetData);
        })
        .catch((error) => console.log("error", error));

      function drawChart(chartData) {
        var data = google
          .visualization
          .arrayToDataTable(chartData);

        var options = {
          chart: {
            title: "Company Performance",
            subtitle: "Sales, Expenses, and Profit: 2014-2017"
          },
          bars: "horizontal"
        };

        var chart = new google
          .charts
          .Bar(document.getElementById("barchart_material"));

        chart.draw(data, google.charts.Bar.convertOptions(options));
      }

      fetch("https://script.google.com/macros/s/AKfycbz1teyXYxbb1vz4Hg1BASUNeONHRGHxuJ_NS9sKJM8YajxQ-1UYSh8tQyzqv_6vZkGJ/exec?sheetName=Sheet2", {redirect: "follow"})
        .then((response) => response.text())
        .then((result) => {
          sheetData = JSON.parse(result);
          drawTable(sheetData);
        })
        .catch((error) => console.log("error", error));

      function drawTable(chartData) {
        var data = google
          .visualization
          .arrayToDataTable(chartData);

        var options = {
          showRowNumber: true,
          width: "80%",
          height: "90%"
        };

        var table = new google
          .visualization
          .Table(document.getElementById("table_div"));

        table.draw(data, options);
      }
    </script>
  </head>
  <body>
    <ul class="nav nav-pills nav-fill gap-2 p-1 small bg-primary rounded-5 shadow-sm" id="pillNav2" role="tablist" style="--bs-nav-link-color: var(--bs-white); --bs-nav-pills-link-active-color: var(--bs-primary); --bs-nav-pills-link-active-bg: var(--bs-white);">
      <li class="nav-item" role="presentation">
        <button class="nav-link active rounded-5" id="home-tab2" data-bs-toggle="tab" type="button" role="tab" aria-selected="true">Home</button>
      </li>
      <li class="nav-item" role="presentation">
        <button class="nav-link rounded-5" id="profile-tab2" data-bs-toggle="tab" type="button" role="tab" aria-selected="false">Profile</button>
      </li>
      <li class="nav-item" role="presentation">
        <button class="nav-link rounded-5" id="contact-tab2" data-bs-toggle="tab" type="button" role="tab" aria-selected="false">Contact</button>
      </li>
    </ul>

    <div id="barchart_material" style="width: 900px; height: 500px"></div>
    <div class="table-responsive" id="table_div" style="margin-top: 40px"></div>

  </body>
</html>